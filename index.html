<!DOCTYPE html>
<style>
  body,
  html,
  main {
    height: 100%;
  }
  main {
    display: flex;
    justify-content: center;
    align-items: center;
  }
</style>
<main>
  <div id="loading">
     Loading..
  </div>
</main>

<script src="dist/pako.min.js"></script>
<script src="dist/wasm_exec.js"></script>
<script>
  (async function () {
    // Polyfill
    if (!WebAssembly.instantiateStreaming) {
      WebAssembly.instantiateStreaming = async (resp, importObject) => {
        const source = await(await resp).arrayBuffer();
        return await WebAssembly.instantiate(source, importObject);
      };
    }

    // Inflate the gzip-compressed file using the Pako library
    const file = window
      .pako
      .ungzip(await(await fetch("dist/boids.wasm.gz")).arrayBuffer())
    const go = new Go();
    WebAssembly
      .instantiate(file, go.importObject)
      .then(result => {
        document
          .querySelector('#loading')
          .remove();
        go.run(result.instance);
      });
  })()
</script>
